<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø¥Ø¯Ø§Ø±Ø© Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¬Ø¨Ø³</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 p-6">
<div class="max-w-6xl mx-auto space-y-6">
  <h1 class="text-3xl font-bold text-center text-blue-800">ğŸ“‹ Ø¥Ø¯Ø§Ø±Ø© Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¬Ø¨Ø³</h1>

  <!-- Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±ÙˆØ¹ -->
  <div class="bg-white shadow-sm p-4 rounded">
    <h2 class="text-xl font-semibold mb-2 text-blue-700">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±ÙˆØ¹ Ø¬Ø¯ÙŠØ¯</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
      <input id="projectName" type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹" class="border p-2 rounded">
      <input id="startDate" type="date" class="border p-2 rounded">
    </div>
    <button onclick="addProject()" class="bg-blue-300 text-blue-900 px-4 py-2 rounded mt-3 hover:bg-blue-400">Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±ÙˆØ¹</button>
  </div>

  <!-- Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ -->
  <div id="projectsContainer" class="space-y-6"></div>
</div>

<script>
let projects = JSON.parse(localStorage.getItem("projects")) || [];

function saveProjects() {
  localStorage.setItem("projects", JSON.stringify(projects));
  renderProjects();
}

function addProject() {
  const name = document.getElementById("projectName").value;
  const date = document.getElementById("startDate").value;
  // if (!name || !date) return alert("âš ï¸ Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙˆØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©");
  projects.push({ id: Date.now(), name, date, notes: '', materials: [], workers: [] });
  document.getElementById("projectName").value = "";
  document.getElementById("startDate").value = "";
  saveProjects();
}

function deleteProject(id) {
  if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ØŸ")) {
    projects = projects.filter(p => p.id !== id);
    saveProjects();
  }
}



// ---------- Ø§Ù„Ù…ÙˆØ§Ø¯ ----------
function addMaterial(pid) {
  const pname = document.getElementById(`mName-${pid}`).value;
  const price = +document.getElementById(`mPrice-${pid}`).value;
  const qty = +document.getElementById(`mQty-${pid}`).value;
  if (!pname || !price || !qty) return alert("âš ï¸ Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§Ù…Ø© ÙƒØ§Ù…Ù„Ø©");
  const project = projects.find(p => p.id === pid);
  project.materials.push({ id: Date.now(), name: pname, price, qty });
  document.getElementById(`mName-${pid}`).value = "";
  document.getElementById(`mPrice-${pid}`).value = "";
  document.getElementById(`mQty-${pid}`).value = "";
  saveProjects();
}

function editMaterial(pid, mid, row) {
  const project = projects.find(p => p.id === pid);
  const mat = project.materials.find(m => m.id === mid);
  row.innerHTML = `
    <td class="border p-2"><input id="editMName-${mid}" class="border p-1 w-full" value="${mat.name}"></td>
    <td class="border p-2"><input id="editMPrice-${mid}" type="number" class="border p-1 w-full" value="${mat.price}"></td>
    <td class="border p-2"><input id="editMQty-${mid}" type="number" class="border p-1 w-full" value="${mat.qty}"></td>
    <td class="border p-2">${mat.price * mat.qty}</td>
    <td class="border p-2 space-x-1">
      <button class="bg-green-200 text-green-900 px-2 py-1 rounded hover:bg-green-300" onclick="saveMaterial(${pid},${mid},this.parentElement.parentElement)">ğŸ’¾ Ø­ÙØ¸</button>
      <button class="bg-red-200 text-red-900 px-2 py-1 rounded hover:bg-red-300" onclick="deleteMaterial(${pid},${mid})"> Ø­Ø°Ù</button>
    </td>
  `;
}

function saveMaterial(pid, mid, row) {
  const project = projects.find(p => p.id === pid);
  const mat = project.materials.find(m => m.id === mid);
  mat.name = document.getElementById(`editMName-${mid}`).value;
  mat.price = +document.getElementById(`editMPrice-${mid}`).value;
  mat.qty = +document.getElementById(`editMQty-${mid}`).value;
  saveProjects();
}

function deleteMaterial(pid, mid) {
  const project = projects.find(p => p.id === pid);
  project.materials = project.materials.filter(m => m.id !== mid);
  saveProjects();
}

// ---------- Ø§Ù„Ø¹Ù…Ø§Ù„ ----------
function addWorker(pid) {
  const wname = document.getElementById(`wName-${pid}`).value;
  const daily = +document.getElementById(`wDaily-${pid}`).value;
  const days = +document.getElementById(`wDays-${pid}`).value;
  const paid = +document.getElementById(`wPaid-${pid}`).value || 0;
  if (!wname || !daily || !days) return alert("âš ï¸ Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ù„ ÙƒØ§Ù…Ù„Ø©");
  const project = projects.find(p => p.id === pid);
  project.workers.push({ id: Date.now(), name: wname, daily, days, paid });
  document.getElementById(`wName-${pid}`).value = "";
  document.getElementById(`wDaily-${pid}`).value = "";
  document.getElementById(`wDays-${pid}`).value = "";
  document.getElementById(`wPaid-${pid}`).value = "";
  saveProjects();
}

function editWorker(pid, wid, row) {
  const project = projects.find(p => p.id === pid);
  const w = project.workers.find(wk => wk.id === wid);
  row.innerHTML = `
    <td class="border p-2"><input id="editWName-${wid}" class="border p-1 w-full" value="${w.name}"></td>
    <td class="border p-2"><input id="editWDaily-${wid}" type="number" class="border p-1 w-full" value="${w.daily}"></td>
    <td class="border p-2"><input id="editWDays-${wid}" type="number" class="border p-1 w-full" value="${w.days}"></td>
    <td class="border p-2"><input id="editWPaid-${wid}" type="number" class="border p-1 w-full" value="${w.paid}"></td>
    <td class="border p-2">${w.daily * w.days - w.paid}</td>
    <td class="border p-2 space-x-1">
      <button class="bg-green-200 text-green-900 px-2 py-1 rounded hover:bg-green-300" onclick="saveWorker(${pid},${wid},this.parentElement.parentElement)">ğŸ’¾ Ø­ÙØ¸</button>
      <button class="bg-red-200 text-red-900 px-2 py-1 rounded hover:bg-red-300" onclick="deleteWorker(${pid},${wid})"> Ø­Ø°Ù</button>
    </td>
  `;
}

function saveWorker(pid, wid, row) {
  const project = projects.find(p => p.id === pid);
  const w = project.workers.find(wk => wk.id === wid);
  w.name = document.getElementById(`editWName-${wid}`).value;
  w.daily = +document.getElementById(`editWDaily-${wid}`).value;
  w.days = +document.getElementById(`editWDays-${wid}`).value;
  w.paid = +document.getElementById(`editWPaid-${wid}`).value;
  saveProjects();
}

function deleteWorker(pid, wid) {
  const project = projects.find(p => p.id === pid);
  project.workers = project.workers.filter(w => w.id !== wid);
  saveProjects();
}

// ---------- Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ ----------
function renderProjects() {
  const container = document.getElementById("projectsContainer");
  container.innerHTML = "";
  projects.forEach(p => {
    const totalMaterials = p.materials.reduce((sum,m)=>sum+m.price*m.qty,0);
    const totalWorkers = p.workers.reduce((sum,w)=>sum+w.paid,0);

    const div = document.createElement("div");
    div.className="bg-white shadow-sm p-4 rounded";

    const header=document.createElement("div");
    header.className="flex justify-between items-center mb-3";
    header.innerHTML=`<h2 class="text-2xl font-semibold text-blue-800">${p.name} <span class="text-gray-500 text-sm">(Ù…Ù† ${p.date})</span></h2>
      <button onclick="deleteProject(${p.id})" class="bg-red-200 text-red-900 px-3 py-1 rounded hover:bg-red-300"> Ø­Ø°Ù</button>`;
    div.appendChild(header);

    // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ§Ø¯
    const matTable=document.createElement("table");
    matTable.className="w-full border mb-3";
    let matHTML=`<thead class="bg-gray-100"><tr>
      <th class="border p-2">Ø§Ù„Ø®Ø§Ù…Ø©</th><th class="border p-2">Ø§Ù„Ø³Ø¹Ø±</th><th class="border p-2">Ø§Ù„ÙƒÙ…ÙŠØ©</th><th class="border p-2">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th><th class="border p-2">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
    </tr></thead><tbody>`;
    p.materials.forEach(m=>{
      matHTML+=`<tr>
        <td class="border p-2">${m.name}</td>
        <td class="border p-2">${m.price}</td>
        <td class="border p-2">${m.qty}</td>
        <td class="border p-2">${m.price*m.qty}</td>
        <td class="border p-2 space-x-1">
          <button class="bg-yellow-200 text-yellow-900 px-2 py-1 rounded hover:bg-yellow-300" onclick="editMaterial(${p.id},${m.id},this.parentElement.parentElement)"> ØªØ¹Ø¯ÙŠÙ„</button>
          <button class="bg-red-200 text-red-900 px-2 py-1 rounded hover:bg-red-300" onclick="deleteMaterial(${p.id},${m.id})"> Ø­Ø°Ù</button>
        </td>
      </tr>`;
    });
    matHTML+=`<tr>
      <td><input id="mName-${p.id}" class="border p-1 w-full" placeholder="Ø§Ù„Ø®Ø§Ù…Ø©"></td>
      <td><input id="mPrice-${p.id}" type="number" class="border p-1 w-full" placeholder="Ø§Ù„Ø³Ø¹Ø±"></td>
      <td><input id="mQty-${p.id}" type="number" class="border p-1 w-full" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©"></td>
      <td><button onclick="addMaterial(${p.id})" class="bg-green-200 text-green-900 px-2 py-1 rounded hover:bg-green-300">Ø¥Ø¶Ø§ÙØ©</button></td>
      <td></td>
    </tr></tbody>`;
    matTable.innerHTML=matHTML;
    div.appendChild(matTable);
    div.appendChild(Object.assign(document.createElement("p"),{className:"font-bold mb-4",textContent:`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®Ø§Ù…Ø§Øª: ${totalMaterials} Ø¬.Ù…`}));

    // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ù…Ø§Ù„
    const workTable=document.createElement("table");
    workTable.className="w-full border mb-3";
    let workHTML=`<thead class="bg-gray-100"><tr>
      <th class="border p-2">Ø§Ù„Ø¹Ø§Ù…Ù„</th><th class="border p-2">Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</th><th class="border p-2">Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…</th><th class="border p-2">Ø§Ù„Ù…Ø¯ÙÙˆØ¹</th><th class="border p-2">Ø§Ù„Ø¨Ø§Ù‚ÙŠ</th><th class="border p-2">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
    </tr></thead><tbody>`;
    p.workers.forEach(w=>{
      workHTML+=`<tr>
        <td class="border p-2">${w.name}</td>
        <td class="border p-2">${w.daily}</td>
        <td class="border p-2">${w.days}</td>
        <td class="border p-2">${w.paid}</td>
        <td class="border p-2">${w.daily*w.days - w.paid}</td>
        <td class="border p-2 space-x-1">
          <button class="bg-yellow-200 text-yellow-900 px-2 py-1 rounded hover:bg-yellow-300" onclick="editWorker(${p.id},${w.id},this.parentElement.parentElement)"> ØªØ¹Ø¯ÙŠÙ„</button>
          <button class="bg-red-200 text-red-900 px-2 py-1 rounded hover:bg-red-300" onclick="deleteWorker(${p.id},${w.id})"> Ø­Ø°Ù</button>
        </td>
      </tr>`;
    });
    workHTML+=`<tr>
      <td><input id="wName-${p.id}" class="border p-1 w-full" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ù…Ù„"></td>
      <td><input id="wDaily-${p.id}" type="number" class="border p-1 w-full" placeholder="Ø§Ù„ÙŠÙˆÙ…ÙŠØ©"></td>
      <td><input id="wDays-${p.id}" type="number" class="border p-1 w-full" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…"></td>
      <td><input id="wPaid-${p.id}" type="number" class="border p-1 w-full" placeholder="Ø§Ù„Ù…Ø¯ÙÙˆØ¹"></td>
      <td><button onclick="addWorker(${p.id})" class="bg-purple-200 text-purple-900 px-2 py-1 rounded hover:bg-purple-300">Ø¥Ø¶Ø§ÙØ©</button></td>
      <td></td>
    </tr></tbody>`;
    workTable.innerHTML=workHTML;
    div.appendChild(workTable);
    div.appendChild(Object.assign(document.createElement("p"),{className:"font-bold",textContent:`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯ÙÙˆØ¹ Ù„Ù„Ø¹Ù…Ø§Ù„: ${totalWorkers} Ø¬.Ù…`}));

    div.appendChild(Object.assign(document.createElement("hr"),{className:"my-3"}));
    div.appendChild(Object.assign(document.createElement("p"),{className:"text-lg font-bold text-gray-800",textContent:`ğŸ’° Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„ÙƒÙ„ÙŠØ©: ${totalMaterials + totalWorkers} Ø¬.Ù…`}));

    container.appendChild(div);
  });
}

renderProjects();
</script>
</body>    <br>
    <hr>
<footer style="background-color:#333; color:white; text-align:center; font-family:Arial, sans-serif;">


      <p>&copy; 2025 0x-ACE||Bedeir Rabea</p>

</footer>
</html>
